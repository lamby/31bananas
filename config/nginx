upstream bananas {
	server		unix:/var/run/gunicorn/bananas.sock;
}

server {
	listen		213.138.100.153:80;

	server_name	bananas.chris-lamb.co.uk;

	client_max_body_size	10M;

	location ~ /(favicon.ico|robots.txt) {
		root 		/usr/share/bananas/media;
		access_log	off;
	}

	location /media {
		root 		/usr/share/bananas/media;
		rewrite         ^/media/[^/]+/(.*)$ /$1 break;
		expires		max;
		access_log	off;

		gzip_vary	on;
		gzip_types	text/plain text/css application/x-javascript text/xml application/xml image/gif image/jpeg image/png;
		gzip_min_length	1400;
	}

	location / {
		proxy_pass              http://bananas;
		proxy_set_header        Host $http_host;
		proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;
		proxy_redirect          off;
		
	}
}
