{% extends "blog/admin/base.html" %}

{% load humanize %}

{% block body_classes %}{{ block.super }} f_blog_admin_edit{% endblock %}

{% block title %}Edit post - {{ block.super }}{% endblock %}

{% block body %}

<nav class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex3-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="{% url "blog:admin:index" %}">Blog admin</a>
  </div>
  <div class="collapse navbar-collapse">
    <div class="navbar-right">
      <form method="POST" action="{% url "blog:admin:delete" post.pk %}" class="js-delete">
        {% csrf_token %}
        <button type="submit" class="btn btn-danger navbar-btn">Delete</button>
      </form>
      {% if post.published %}
      <a href="{{ post.get_absolute_url }}" class="btn btn-default navbar-btn">View post</a>
      <button type="button" class="btn btn-success navbar-btn js-save">Save</button>
      {% else %}
      <button type="button" data-name="{{ form.publish.name }}" class="btn btn-success navbar-btn js-publish">Publish</button>
      <a href="{{ post.get_absolute_url }}" class="btn btn-default navbar-btn">Preview</a>
      <button type="button" class="btn btn-default navbar-btn js-save">Save</button>&nbsp;
      {% endif %}
    </div>
  </div>
</nav>

<div class="container">

  <div class="row">
    <div class="col-sm-12">
      <form method="POST" action="" class="form-post" data-url="{% url "blog:admin:xhr-edit" post.pk %}">
        {% csrf_token %}

        {{ form.errors }}

        <div class="form-group {% if form.title.errors %}has-error{% endif %}">
          <input type="text" class="form-control input-lg {% if not post.published %}js-populate-slug{% endif %}" name="{{ form.title.html_name }}" id="{{ form.title.id_for_label }}" value="{{ form.title.value|default:"" }}" placeholder="Title">
          <div class="help-block">
            {% for error in form.title.errors %}{{ error }}{% endfor %}
          </div>
        </div>

        <div class="form-group {% if form.content.errors %}has-error{% endif %}">
          <textarea class="form-control" name="{{ form.content.html_name }}" id="{{ form.content.id_for_label }}" rows="60" placeholder="Start writing here...">{{ form.content.value|default:"" }}</textarea>
          <div class="help-block">
            {% for error in form.content.errors %}{{ error }}{% endfor %}
          </div>
        </div>

        <div class="form-group {% if form.slug.errors %}has-error{% endif %}">
          <label for="{{ form.slug.id_for_label }}" class="control-label">Slug</label>
          <div class="input-group">
            <span class="input-group-addon">{{ settings.SITE_URL }}{% url "blog:post" "" %}</span>
            <input type="text" class="form-control input-sm js-slug" name="{{ form.slug.html_name }}" id="{{ form.slug.id_for_label }}" value="{{ form.slug.value|default:"" }}">
          </div>
          <div class="help-block">
            {% for error in form.slug.errors %}{{ error }}{% endfor %}
          </div>
        </div>

        <ul class="list-inline">
          {% for x in form.fields.tags.queryset %}
          <li>
            <label for="{{ form.tags.html_name }}_{{ x.pk }}">
              <input id="{{ form.tags.html_name }}_{{ x.pk }}" name="{{ form.tags.html_name }}" type="checkbox" value="{{ x.pk }}" {% if x.pk in form.tags.value %}checked{% endif %}> {% if x.planet %}Planet {% endif %}{{ x.name }}
            </label>
          </li>
          {% endfor %}
        </ul>

        <p>
          <label>
            Set cover image
            <small>(<a href="http://unsplash.com/archive">unsplash</a>,
              <a href="http://cabinporn.com/archive">cabinporn</a>,
              <a href="http://www.reddit.com/r/DesignPorn">sfwporn</a>,
              <a href="http://nos.twnsnd.co/">nos</a>,
              <a href="http://superfamous.com/">superfamous</a>,
              <a href="http://www.dotspin.com/the-commons/">dotspin</a>,
              <a href="http://www.gratisography.com/">gratisography</a>,
              <a href="http://littlevisuals.co/">littlevisuals.co</a>,
              <a href="http://www.splashbase.co/">splashbase.co</a>)

            </small>
          </label>
          <input type="text" value="" class="form-control js-cover-url" placeholder="Paste an URL &hellip;" data-url="{% url "blog:admin:xhr-cover-url" post.pk %}">
        </p>

        <p>
          {{ form.commentable }}
          <label for="{{ form.commentable.id_for_label }}">Comments enabled</label>
        </p>
      </form>
    </div>
  </div>
</div>

</form>

{% endblock  %}
